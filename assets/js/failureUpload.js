(()=>{function t(t,e,r,n,a,o,i){try{var f=t[o](i),u=f.value}catch(t){return void r(t)}f.done?e(u):Promise.resolve(u).then(n,a)}function e(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,f=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return f=t.done,t},e:function(t){u=!0,i=t},f:function(){try{f||null==n.return||n.return()}finally{if(u)throw i}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}!function(){var r=document.querySelector(".failure-upload"),n=r.querySelector(".failure-upload__canvas-row"),a=r.querySelector(".failure-upload__add-canvas"),o=r.querySelector(".failure-upload__finish-btn"),i=r.querySelector("#failure1"),f=[[]];function u(t){var r=t.getContext("2d"),n=30,a="black";t.width=360,t.height=360;var o=13,i=25,u="1"===localStorage.getItem("turn")?0:1,l={},c=JSON.parse(localStorage.getItem("board")),s=[[1,0],[0,-1],[0,1],[-1,0]];function v(){r.fillStyle="#e38d00",r.fillRect(0,0,360,360);for(var t=0;t<12;t++)for(var e=0;e<12;e++)r.strokeStyle=a,r.lineWidth=1,r.strokeRect(25*t+n,25*e+n,25,25);function o(t,e){r.fillStyle=a,r.lineWidth=1,r.beginPath(),r.arc(t,e,10/3,0,2*Math.PI),r.fill()}r.fillStyle=a,r.lineWidth=1;for(var f=0;f<2;f++)for(var u=0;u<2;u++)o((3+f)*i+n+5*f*i,(3+u)*i+n+5*u*i);o(180,180)}function d(t,e,a){r.fillStyle=a,r.beginPath(),r.arc(t*i+n,e*i+n-.2,10,0,2*Math.PI),r.fill()}var h=function(t,e){for(var r=0;r<c.length;r++){var n=g(r)[0],a=g(r)[1];1===c[p(n,a)]?d(n,a,"black"):2===c[p(n,a)]&&d(n,a,"white")}},p=function(t,e){return t>=o||t<0||e>=o||e<0?void 0:t+e*o},g=function(t){return[t%o,Math.floor(t/o)]},y=function(t,e){return t>10&&t<340&&e>10&&e<340},m=function(t,e){return[Math.floor(Math.abs(t-n)/i),Math.floor(Math.abs(e-n)/i)]};v(),t.addEventListener("mouseup",(function(r){var n=m(r.offsetX,r.offsetY)[0],a=m(r.offsetX,r.offsetY)[1];if(y(r.offsetX,r.offsetY)){if(-1!=c[p(n,a)])return;if(c[p(n,a)]=u%2==0?1:2,!function(t,r){function n(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=0,i=[],f=[];function u(t,e,r){if(a)return!1;for(var l=0;l<4;l++){if(a)return!1;var v=t+s[l][0],d=e+s[l][1];if(!(v<0||v>=o||d<0||d>=o)){var h=String(v)+"/"+String(d);if(!i.includes(h)){if(-1===c[p(v,d)])return a+=1,!1;c[p(v,d)]===r&&(i.push(h),u(v,d,r))}}}return!a&&(n&&f.push(p(t,e)),!n||Array.from(new Set(f)))}return u(t,e,r)}for(var a=u%2==0?1:2,i=1===a?2:1,f=[],v=[],d=0;d<4;d++){var h=t+s[d][0],g=r+s[d][1];c[p(h,g)]===i&&f.push([h,g])}if(!f.length)return!n(t,r,a);var y,m=e(f);try{for(m.s();!(y=m.n()).done;){var S=y.value,b=n(S[0],S[1],i,!0);if(b){var w,I=e(b);try{for(I.s();!(w=I.n()).done;){var O=w.value;v.push(O)}}catch(t){I.e(t)}finally{I.f()}}}}catch(t){m.e(t)}finally{m.f()}if(!v.length)return!n(t,r,a);if(!function(t,e,r,n){for(var a=[],o=0;o<4;o++){var i=t+s[o][0],f=e+s[o][1];a.push(c[p(i,f)])}if(1===n.length&&-1===a.indexOf(r)&&-1===a.indexOf(-1)){var v=p(t,e)>n[0]?"".concat(p(t,e),"/").concat(n[0]):"".concat(n[0],"/").concat(p(t,e)),d=u+1;return l[v]!==d-1&&(l[v]=d,!0)}return!0}(t,r,a,v))return!1;for(var M=0,k=v;M<k.length;M++){var q=k[M];c[q]=-1}return!0}(n,a))return void(c[p(n,a)]=-1);var i=t.id[t.id.length-1];f[Number(i)-1].push(p(n,a)),u++,v(),h()}})),t.addEventListener("mousemove",(function(t){if(y(t.offsetX,t.offsetY)){var e=m(t.offsetX,t.offsetY)[0],r=m(t.offsetX,t.offsetY)[1];-1!==c[p(e,r)]?(v(),h()):u%2==0?(v(),h(),d(e,r,"rgba(0,0,0,0.5)")):(v(),h(),d(e,r,"rgba(255,255,255,0.5)"))}})),t.addEventListener("mouseleave",(function(){v(),h()}))}var l=2,c=function(){var e,r=(e=regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),r={board:JSON.parse(localStorage.getItem("board")),turn:localStorage.getItem("turn"),answer:JSON.parse(localStorage.getItem("answer")),failures:f,title:localStorage.getItem("title")},t.next=4,fetch("save-question",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:r})});case 4:201===t.sent.status&&(alert("정상적으로 업로드 되었습니다"),location.replace("/"));case 6:case"end":return t.stop()}}),t)})),function(){var r=this,n=arguments;return new Promise((function(a,o){var i=e.apply(r,n);function f(e){t(i,a,o,f,u,"next",e)}function u(e){t(i,a,o,f,u,"throw",e)}f(void 0)}))});return function(t){return r.apply(this,arguments)}}();u(i),a.addEventListener("click",(function(t){t.preventDefault(),f.push([]);var e=document.createElement("canvas");e.id="failure".concat(l),e.className="failure-canvas",n.appendChild(e),l+=1,u(e)})),o.addEventListener("click",c)}()})();